<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Laundry Mini ‚Äì Optimiseur ultra simple</title>
<style>
  :root{--bg:#0b1220;--card:#0f172a;--ink:#e6edf5;--mut:#9aa6b2;--bd:#1f2937;--accent:#38bdf8;--chip:#111827}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Inter,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b1220,#0b1220 60%,#0a1627);color:var(--ink)}
  header{padding:18px 14px;border-bottom:1px solid var(--bd);text-align:center}
  h1{margin:0;font-size:18px;letter-spacing:.2px}
  .wrap{max-width:760px;margin:0 auto;padding:16px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .mut{color:var(--mut);font-size:12px}
  .control{display:flex;align-items:center;gap:8px;padding:8px 12px;border:1px solid rgba(255,255,255,.1);border-radius:999px;background:var(--chip)}
  .control input{width:70px;padding:6px;border-radius:8px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);color:var(--ink);text-align:right}
  .chip{display:flex;align-items:center;gap:10px;background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:10px 12px}
  .name{min-width:160px}
  .desc{color:var(--mut);font-size:12px}
  .count{min-width:32px;text-align:center}
  .btn{border:1px solid rgba(255,255,255,.18);background:rgba(56,189,248,.15);color:var(--ink);padding:8px 12px;border-radius:12px;cursor:pointer}
  .btn.ghost{background:transparent}
  .btn.round{width:30px;height:30px;border-radius:999px;display:inline-flex;align-items:center;justify-content:center}
  .grid{display:grid;gap:10px}
  .loads{display:grid;gap:12px;margin-top:8px}
  .load{padding:12px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.08)}
  .load .hdr{display:flex;justify-content:space-between;gap:10px}
  .ok{color:#bbf7d0}.warn{color:#fecaca}
  table{width:100%;border-collapse:collapse;margin-top:6px}
  th,td{border-bottom:1px solid rgba(255,255,255,.08);padding:8px 6px;text-align:left;font-size:14px}
  .right{text-align:right}
</style>
</head>
<body>
<header><h1>üß∫ Laundry Mini ‚Äî Moins de batt√©es, point.</h1></header>

<div class="wrap">
  <!-- Q1: capacit√© -->
  <section class="card" style="margin-bottom:12px">
    <div class="row">
      <div class="control">
        <span>Capacit√©/batt√©e</span>
        <input id="capacity" type="number" min="1" value="8" />
        <span class="mut">articles</span>
      </div>
      <label class="control" title="S√©pare le denim s'il est neuf">
        <input id="newJeans" type="checkbox" />
        <span>Jeans neufs ?</span>
      </label>
    </div>
    <div class="mut" style="margin-top:6px">Astuce : la plupart des v√™tements supportent 30 ¬∞C. Les serviettes/draps se lavent plut√¥t √† 60 ¬∞C.</div>
  </section>

  <!-- Q2: ajoute les quantit√©s avec + / ‚àí -->
  <section class="card">
    <div class="mut" style="margin-bottom:8px">Ajoute tes pi√®ces (tapote + / ‚àí). On fusionne automatiquement ce qui peut l‚Äô√™tre.</div>
    <div id="chips" class="grid"></div>
    <div class="row" style="margin-top:10px">
      <button id="optimize" class="btn">‚öôÔ∏è Optimiser</button>
      <button id="reset" class="btn ghost">R√©initialiser</button>
    </div>
  </section>

  <!-- R√©sultat -->
  <section class="card" style="margin-top:12px">
    <div id="result"></div>
  </section>
</div>

<script>
/* --- Mod√®le ultra-condens√© --- */
const CATS = [
  { key:"blancs",   name:"Blancs",       desc:"t-shirts/draps blancs",            cycle:"Coton 40 ¬∞C",      temp:40, group:"whites" },
  { key:"clairs",   name:"Clairs",       desc:"beige, gris clair, pastels",      cycle:"Couleurs 30 ¬∞C",   temp:30, group:"lights" },
  { key:"couleurs", name:"Couleurs",     desc:"bleu/vert moyens",                 cycle:"Couleurs 30 ¬∞C",   temp:30, group:"lights" },
  { key:"vives",    name:"Vives/Rouges", desc:"rouge, fuchsia, orange vif",       cycle:"Couleurs 30 ¬∞C",   temp:30, group:"vivid"  },
  { key:"fonces",   name:"Fonc√©s/Noirs", desc:"marine, anthracite, noir",         cycle:"Fonc√©es 30 ¬∞C",    temp:30, group:"darks"  },
  { key:"denim",    name:"Denim",        desc:"jeans (√† l‚Äôenvers)",               cycle:"Jeans 30 ¬∞C",      temp:30, group:"darks"  },
  { key:"delicats", name:"D√©licats",     desc:"laine/soie/sport",                 cycle:"D√©licat 20‚Äì30 ¬∞C", temp:30, group:"delicate" },
  { key:"chaud",    name:"Serviettes/Draps", desc:"linge de maison",              cycle:"Coton 60 ¬∞C",      temp:60, group:"hot" }
];

const state = Object.fromEntries(CATS.map(c=>[c.key,0]));
const $ = s => document.querySelector(s);

function renderChips(){
  const box = $("#chips");
  box.innerHTML = "";
  CATS.forEach(c=>{
    const el = document.createElement("div");
    el.className = "chip";
    el.innerHTML = `
      <div class="name"><b>${c.name}</b><div class="desc">${c.desc}</div></div>
      <button class="btn round" data-k="${c.key}" data-delta="-1">‚àí</button>
      <div class="count" id="count-${c.key}">${state[c.key]}</div>
      <button class="btn round" data-k="${c.key}" data-delta="1">+</button>
    `;
    box.appendChild(el);
  });
  box.addEventListener("click", e=>{
    const btn = e.target.closest("button[data-k]");
    if (!btn) return;
    const k = btn.getAttribute("data-k");
    const d = Number(btn.getAttribute("data-delta"));
    state[k] = Math.max(0, (state[k]||0) + d);
    $("#count-"+k).textContent = state[k];
  }, { once:false });
}

function optimize(){
  const cap = Math.max(1, Number($("#capacity").value||8));
  const newJeans = $("#newJeans").checked;

  // 1) R√®gles de fusion pour minimiser
  const whites   = state.blancs;
  const lights   = state.clairs + state.couleurs;            // fusion
  const vivid    = state.vives;                              // isol√© (risque de transfert)
  const darks    = state.fonces + (newJeans ? 0 : state.denim); // denim fusionn√© si pas neuf
  const denimNew = newJeans ? state.denim : 0;               // jeans neufs √† part
  const delicate = state.delicats;                           // m√©lang√©s entre eux
  const hot      = state.chaud;

  const groups = [
    {label:"D√©licats",     qty:delicate, cycle:"D√©licat 20‚Äì30 ¬∞C", temp:30, note:"Essorage doux, filet recommand√©."},
    {label:"Blancs",       qty:whites,   cycle:"Coton 40 ¬∞C",      temp:40, note:"√âvite tout m√©lange avec Vives."},
    {label:"Clairs/Couleurs", qty:lights, cycle:"Couleurs 30 ¬∞C", temp:30, note:"Pastels et couleurs moyennes compatibles."},
    {label:"Vives/Rouges", qty:vivid,    cycle:"Couleurs 30 ¬∞C",   temp:30, note:"Peuvent d√©teindre, surtout neuves."},
    {label:"Fonc√©s/Noirs", qty:darks,    cycle:"Fonc√©es 30 ¬∞C",    temp:30, note:"Retourner les v√™tements."},
    {label:"Jeans neufs",  qty:denimNew, cycle:"Jeans 30 ¬∞C",      temp:30, note:"S√©parer les 1‚Äì2 premiers lavages."},
    {label:"Serviettes/Draps", qty:hot,  cycle:"Coton 60 ¬∞C",      temp:60, note:"Linge de maison, peluches possibles."}
  ].filter(g=>g.qty>0);

  // 2) √âclater en batt√©es par capacit√© (ceil)
  const loads = [];
  groups.forEach(g=>{
    const n = Math.ceil(g.qty / cap);
    for (let i=0;i<n;i++){
      loads.push({
        name: g.label,
        temp: g.temp,
        cycle: g.cycle,
        count: (i===n-1)? (g.qty - cap*i) : cap,
        note: g.note
      });
    }
  });

  // 3) Tri affichage : D√©licats ‚Üí temp croissant ‚Üí Serviettes en dernier
  loads.sort((a,b)=> (a.name.includes("D√©licat")?-1:0) - (b.name.includes("D√©licat")?-1:0) || a.temp-b.temp || a.name.localeCompare(b.name));
  const totalLoads = loads.length;

  // 4) Rendu
  const warn = [];
  if (state.blancs>0 && state.vives>0) warn.push("√âvite de m√©langer Blancs et Vives.");
  if (newJeans && state.denim>0) warn.push("Jeans neufs s√©par√©s (risque de d√©coloration).");

  $("#result").innerHTML = renderSummary(totalLoads, cap, loads, warn);
}

function renderSummary(total, cap, loads, warnings){
  if (!loads.length) return `<p class="mut">Ajoute au moins 1 pi√®ce puis clique <b>Optimiser</b>.</p>`;
  let html = `<div class="ok"><b>${total} batt√©e(s)</b> ¬∑ Capacit√© ${cap} article(s)</div>`;
  html += `<table><thead><tr><th>#</th><th>Lot</th><th>Cycle</th><th>Temp.</th><th class="right">Qt√©</th></tr></thead><tbody>`;
  loads.forEach((L,i)=>{
    html += `<tr><td>${i+1}</td><td>${L.name}</td><td>${L.cycle}</td><td>${L.temp} ¬∞C</td><td class="right">${L.count}</td></tr>
             <tr><td></td><td colspan="4" class="mut">${L.note}</td></tr>`;
  });
  html += `</tbody></table>`;
  if (warnings.length) html += `<p class="warn"><b>Attention :</b> ${warnings.join(" ")}</p>`;
  return html;
}

/* --- Init --- */
renderChips();
$("#optimize").addEventListener("click", optimize);
$("#reset").addEventListener("click", ()=> location.reload());
</script>
</body>
</html>
